https://www.frontiersin.org/journals/earth-science/articles/10.3389/feart.2022.1069166/full

Modeling seismic wave propagation in the Loess Plateau using a viscoacoustic wave equation with explicitly expressed quality factor
Ziduo HuZiduo Hu1Jidong Yang
Jidong Yang2*Linghe HanLinghe Han1Jianping HuangJianping Huang2Shanyuan QinShanyuan Qin2Jiaxing SunJiaxing Sun2Youcai YuYoucai Yu2
1Research Institute of Petroleum Exploration and Development-Northwest PetroChina, Lanzhou, China
2School of Geosciences, Laboratory for Marine Mineral Resources, National Laboratory for Marine Science and Technology, China University of Petroleum (East China), Qingdao, Shandong, China
The thick Quaternary loess on the Loess Plateau of China produces strong seismic attenuation, resulting in weak reflections from subsurface exploration targets. Accurately simulating seismic wavefield in the Loess Plateau is important for guiding subsequent data processing and interpretation. We present a 2D/3D wavefield simulation method for the Loess Plateau using a viscoacoustic wave equation with explicitly expressed quality factor. To take into account the effect of irregular surface, we utilize a vertically deformed grid to represent the topography, and solve the viscoacoustic wave equation in a regular computational domain that conforms to topographic surface. Grid deformation introduces the partial derivatives such as ∂vx/∂z and ∂vy/∂z in the wave equation, which is difficult to be accurately computed using traditional staggered-grid finite-difference method. To mitigate this issue, a finite-difference scheme based on a fully staggered-grid is adopted to solve the viscoacoustic wave equation. Numerical experiments for a simple layer model and 2D/3D realistic Loess Plateau models demonstrate the feasibility and adaptability of the proposed method. The 3D modeling results show comparable amplitude and waveform characteristics to the field data acquired from the Chinese Loess Plateau, suggesting a good performance of the proposed modeling method.

Introduction
Seismic modeling always plays an important role in the study of wave phenomenon, and provides numerical propagators for seismic imaging and inversion (Bording and Lines, 1997; Virieux et al., 2009). According to theoretical background and numerical implementation, seismic modeling approaches can be categorized into two basic groups (Carcione et al., 2002): ray-based and wave-equation methods. Each group has its own pros and cons, and both of them have been widely used in seismic modeling, imaging and inversion.

Seismic ray is a high-frequency asymptotic solution of the wave equation (Červený, 2001), of which the traveltime and amplitude are determined by the eikonal and transport equations, respectively. It decomposes the coupled wavefields into independent single-phase waves, including direct wave, reflection, refraction, transmission, converted wave, multiples, etc (Červený et al., 2007). This makes it easy to study a specific wave phenomenon in complicated subsurface structures. In the past half century, ray-based methods have evolved from classical kinematic ray tracing (Julian and Gubbins, 1977; Um and Thurber, 1987), through paraxial ray tracing (Beydoun and Keho, 1987) and Maslov asymptotic theory (Maslov et al., 1972; Chapman and Drummond, 1982; Kendall and Thomson, 1993), then to Gaussian beam (Červený et al., 1982; Müller, 1984; Nowack and Aki, 1984). Due to high computational efficiency, ray-based Kirchhoff and beam migrations have become routine tools for seismic imaging and migration velocity analysis in the industry (Hill, 1990, 2001; Gray and May 1994; Yang et al., 2018, 2022).

The other group of seismic modeling is to directly solve the wave equation onto a discretized grid using numerical solvers. Typical numerical algorithms include finite-difference, finite-element, pseudo-spectrum, spectrum-element and boundary-element approaches (Carcione et al., 2002). Because of relatively cheap cost, the finite-difference has been extensively used for wavefield simulation (Kristek and Moczo, 2003; Etgen and O’Brien, 2007), reverse-time migration (McMechan, 1989; Wu et al., 1996) and full-waveform inversion (Mulder and Plessix, 2008; Vigh et al., 2009; Virieux and Operto, 2009) in exploration seismology. Using the triangle or tetrahedral mesh to discretize the geological model, the finite-element approach can accurately simulate wave propagation in strong heterogeneous media (Marfurt, 1984; De Basabe and Sen, 2009; Komatitsch et al., 2010). But due to large computational cost, it is usually limited for small-scale problems, e.g., in the fault zone and oil & gas reservoir. The spectrum-element method inherits the flexibility of finite-element and the accuracy of spectral method, and the diagonal mass matrix using a specific discretization and integration rule results in a higher efficiency than finite-element method (Komatitsch and Tromp, 1999; Komatitsch et al., 2000; Komatitsch and Tromp, 2002). These advantages make it have be widely applied to wavefield simulation and adjoint tomography in regional and global seismology (Komatitsch et al., 2002; Tape et al., 2009; Lei et al., 2020).

The Loess Plateau of China has the thickest and largest loess coverage in the world, which was deposited in the Pleistocene under particular geological, geomorphological and climatic conditions (Sun, 2002). Rich oil and gas resource under the loess promote extensive seismic exploration in this area. Low-velocity loess layer and complicated topography produce strong seismic attenuation and scattering noise, resulting in deep reflections with a very low signal-to-noise ratio (SNR). The low-quality observed data present a large challenge for subsequent processing and interpretation (Wang et al., 2004; Wang et al., 2014). Accurately simulating the wavefields of the Loess Plateau helps to understand noise generation mechanism and attenuation effect of thick loess layer, which can guide subsequent data processing and imaging. In the wavefield modeling for the Loess Plateau, it is necessary to take into account the irregular topography and strong attenuation due to complex near-surface geology.

There are many rheological models to characterize seismic attenuation during wave propagation. For instance, a complex-valued velocity can be directly introduced into the frequency-domain wave equation to describe phase dispersion and amplitude dissipation (Liao and McMechan, 1996; Stekl and Pratt, 1998; Aki and Richards, 2002). On the other hand, in the time domain, the nearly constant attenuation effect within a frequency band can be implemented by a combination of springs and dashpots in series and/or parallel (Carcione, 2007). Typical viscous models include classical and generalized Maxwell body (Emmerich and Korn, 1987), Kelvin-Voigt body (Carcione et al., 2004), and standard linear solid body (Liu et al., 1976; Carcione, 1993; Guo et al., 2019). Using a fractional time derivative, Kjartansson (1979) presented an alternative constant quality factor (Q) model to describe the stress and strain relation. Zhu and Harris (2014) utilized a fractional Laplacian operator to approximate the fractional time derivative and obtained a simplified constant-Q wave equation. Later, many hybrid-domain solvers, including local homogeneous approximation (Chen et al., 2016; Wang et al., 2017; Xing and Zhu, 2019; Wang et al., 2022), low-rank approximation (Sun et al., 2015), Hermite distributed approximation (Yao et al., 2017), are proposed to produce more accurate numerically solution. Recently, Yang and Zhu (2018) presented a complex-valued wave equation to simulate viscoacoustic wave propagation, which has an explicitly expressed Q and can be easily used in full-waveform inversion (Yang et al., 2020).

The Loess Plateau of China has diverse geomorphic features, such as hill, tableland, ditch, ridges and mounds, which results into a complex irregular topography. In seismic modeling using the finite-difference, many strategies have been developed to handle topography and free surface. Levander (1988) implemented a flat free-surface boundary condition using the image method. Later, this approach was extended to highly irregular topography by Robertsson (1996). Mittet (2002) treated elastic Hooke’s tensor on the free surface as that in a transversely isotropic medium and presented a simple implementation of free-surface. Nakamura et al. (2012) proposed an efficient Heterogeneity, Oceanic layer and Topography (HOT) finite-difference method to compute wavefields at the solid-air, fluid-air and fluid-solid boundaries. Instead of directly representing the topography at a regularly and densely sampled Cartesian grid, an alternative way is to transform the physical curved domain to a regular computational grid (Hestholm and Ruud, 1994; Hestholm and Ruud, 1998). This curvilinear transformation can avoid the strong scatterings from the staircase topography and is relatively easily to implement the free-surface condition (Hestholm, 1999; Hestholm and Ruud, 2002; Zhang et al., 2012). At current stage, this approach has been extended to conform both topographic surface and interior layers in viscous and anisotropic media (Sun et al., 2016; Shragge and Tapley, 2017; Konuk and Shragge, 2020; Sun et al., 2021).

In this work, we present a viscoacoustic modeling method to study seismic wave phenomena in the Loess Plateau. A viscoacoustic wave equation is first derived based on a non-linear optimization for the frequency-independent Q effect within a frequency band (Fichtner and van Driel, 2014). To conform to the topographic surface, a vertically deformed grid is adopted to transform the irregular domain to a regular computational coordinate (Jastram and Tessmer, 1994; de la Puente et al., 2014). This strategy does not introduce as many additional partial derivatives as the curvilinear grid method that deforms along three axises, and thus it does not increase too much computational cost compared with that computed on traditional Cartesian grid. In addition, to accurately compute the spatial derivatives such as ∂vx/∂z and ∂vy/∂z, we apply a fully staggered-grid finite-difference scheme (Lisitsa and Vishnevskiy, 2010; de la Puente et al., 2014) to numerically solve the viscoacoustic wave equation on a vertical deformed grid. Numerical experiments for a simple layer model and 2D/3D Loess Plateau models as well as a comparison between synthetic and field data demonstrate the proposed method can accurately simulate wave propagation in the Loess Plateau with thick loess layers.

Theory
Viscoacoustic wave equation with explicitly expressed Q
In viscoacoustic medium, the pressure p (x, t) and particle velocity v (x, t) satisfy a constitutive relation as

∂
p
(
x
,t
)
∂
t
=
∫
∞
−
∞
∂
κ
(
x
,
t
−
t
′
)
∂
t
∇
⋅
v
(
x
,
t
′
)
d
t
′
,
(
1
)
where v = (vx, vy, vz), and subscripts x, y and z denote particle velocity components along different axises. κ(x, t) is a time-dependent bulk modulus and can be constructed by superposing N groups of relaxation mechanisms (Fichtner and van Driel, 2014):

κ
(
x
,
t
)
=
κ
0
(
x
)
[
1
+
1
Q
(
x
)
∑
N
l
=
1
D
(
l
)
exp
(
−
t
τ
(
l
)
)
]
H
(
t
)
,
(
2
)
where 
κ
0
(
x
)
=
ρ
(
x
)
v
2
p
(
x
)
 is the relaxed bulk modulus, ρ(x) and vp(x) denote the density and P-wave velocity, Q(x) is the quality factor, and H(t) is the step function. D(l) and τ(l) (1 < = l < = N) are the weights and decay times of different relaxation mechanisms, which can be computed by solving a non-linear optimization problem using a simulated annealing process to fit the frequency-independent Q in a limited band. In this study, we set the reference frequency to 1 Hz and the frequency band to [1, 150] Hz with three relaxation mechanisms. The resulting coefficients are shown in Table 1.

TABLE 1
www.frontiersin.org
TABLE 1. The weights and decay times of three relaxation mechanisms used in the viscoacoustic modeling.

Taking the time derivative of κ(x, t), we have

∂
κ
(
x
,
t
)
∂
t
=
κ
0
(
x
)
[
1
Q
(
x
)
∑
N
l
=
1
(
−
D
(
l
)
τ
(
l
)
exp
(
−
t
τ
(
l
)
)
)
H
(
t
)
+
(
1
+
s
Q
(
x
)
)
δ
(
t
)
]
,
(
3
)
where δ(t) is the Kronecker delta function, and s is the summation of weights, i.e., 
s
=
∑
N
l
=
1
D
(
l
)
. Inserting Eq. 3 into the constitutive relation yields

∂
p
(
x
,
t
)
∂
t
=
κ
0
(
x
)
[
(
1
+
s
Q
(
x
)
)
∇
⋅
v
(
x
,
t
)
−
1
Q
(
x
)
∑
N
l
=
1
Φ
(
l
)
(
x
,
t
)
]
,
(
4
)
where the memory variables Φ(l)(x, t) are defined as

Φ
(
l
)
(
x
,
t
)
=
D
(
l
)
τ
(
l
)
∫
∞
−
∞
exp
(
−
t
−
t
′
τ
(
l
)
)
H
(
t
−
t
′
)
∇
⋅
v
(
x
,
t
′
)
d
t
′
,
(
5
)
and satisfy

∂
Φ
(
l
)
(
x
,
t
)
∂
t
=
−
1
τ
(
l
)
Φ
(
l
)
(
x
,
t
)
+
D
(
l
)
τ
(
l
)
∇
⋅
v
(
x
,
t
)
.
(
6
)
Considering the second Newton law and assembling Eqs 4, 6, we obtain a viscoacoustic wave equation with the explicitly expressed Q as

⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
ρ
(
x
)
∂
v
(
x
,
t
)
∂
t
=
∇
p
(
x
,
t
)
,
∂
p
(
x
,
t
)
∂
t
=
ρ
(
x
)
v
2
p
(
x
)
[
(
1
+
s
Q
(
x
)
)
∇
⋅
v
(
x
,
t
)
−
1
Q
(
x
)
∑
N
l
=
1
Φ
(
l
)
(
x
,
t
)
]
+
f
(
t
)
δ
(
x
−
x
s
)
,
∂
Φ
(
l
)
(
x
,
t
)
∂
t
=
−
1
τ
(
l
)
Φ
(
l
)
(
x
,
t
)
+
D
(
l
)
τ
(
l
)
∇
⋅
v
(
x
,
t
)
,
(
7
)
where xs denotes the source location, and f(t) is the source time function.

Compared with existing viscoacoustic wave equations, such as the standard linear solid model (Carcione, 1990; Guo and Mcmechan, 2017) and fractional-Laplacian method (Zhu and Harris, 2014; Xing and Zhu, 2019), Eq. 7 has the following advantages in seismic modeling. 1) The quality factor Q is explicitly incorporated in the wave equation, which does not need to be converted to stress and strain relaxation times as in the standard linear solid method. 2) Eq. 7 can be efficiently solved using any time-domain finite-difference schemes, which does involves the Fourier transform or more complicated mixed-domain solvers as in the fractional Laplacian based methods. 3) As shown in Fichtner and van Driel (2014), the frequency-dependent Q effect can also be simulated by recomputing the weights D(l) and relaxation times τ(l).

Representation of the topographic surface on vertically deformed grids
To conform to the topographic surface of the Loess Plateau, here we use a vertically deformed grid to map the irregular physical space x = (x, y, z) to a regular computational domain α = (α, β, γ), which is given by

⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
α
=
x
,
β
=
y
,
γ
=
γ
m
a
x
z
+
ζ
(
x
,
y
)
z
m
a
x
+
ζ
(
x
,
y
)
,
(
8
)
where ζ(x, y) is the elevation of topography (Figure 1), zmax is the maximum depth of the region of interest, γmax = zmax+ζmax, and ζmax is the maximum of elevation.

FIGURE 1
www.frontiersin.org
FIGURE 1. An example of 2D topography to illustrate the basic parameters in the mapping from the physical space to computational domain.

With the coordinate transform relation in Eq. 8, the partial derivatives can be computed as

⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎩
∂
∂
x
=
∂
∂
α
+
[
γ
m
a
x
−
γ
z
m
a
x
+
ζ
(
x
,
y
)
∂
ζ
(
x
,
y
)
∂
x
]
∂
∂
γ
,
∂
∂
y
=
∂
∂
β
+
[
γ
m
a
x
−
γ
z
m
a
x
+
ζ
(
x
,
y
)
∂
ζ
(
x
,
y
)
∂
y
]
∂
∂
γ
,
∂
∂
z
=
[
γ
m
a
x
z
m
a
x
+
ζ
(
x
,
y
)
]
∂
∂
γ
.
(
9
)
By setting

⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎩
c
x
=
γ
m
a
x
−
γ
z
m
a
x
+
ζ
(
x
,
y
)
∂
ζ
(
x
,
y
)
∂
x
,
c
y
=
γ
m
a
x
−
γ
z
m
a
x
+
ζ
(
x
,
y
)
∂
ζ
(
x
,
y
)
∂
y
,
c
z
=
γ
m
a
x
z
m
a
x
+
ζ
(
x
,
y
)
,
(
10
)
The viscoacoustic wave equation in Eq. 7 can be rewritten in the new coordinate as

⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
ρ
(
α
)
∂
v
(
α
,
t
)
∂
t
=
̄
∇
p
(
α
,
t
)
,
∂
p
(
α
,
t
)
∂
t
=
ρ
(
α
)
v
2
p
(
α
)
[
(
1
+
s
Q
(
α
)
)
̄
∇
⋅
v
(
α
,
t
)
−
1
Q
(
α
)
∑
N
l
=
1
Φ
(
l
)
(
α
,
t
)
]
+
f
(
t
)
δ
(
α
−
α
s
)
,
∂
Φ
(
l
)
(
α
,
t
)
∂
t
=
−
1
τ
(
l
)
Φ
(
l
)
(
α
,
t
)
+
D
(
l
)
τ
(
l
)
̄
∇
⋅
v
(
α
,
t
)
,
(
11
)
With a generalized partial derivative operator

̄
∇
=
⎡
⎢
⎢
⎢
⎢
⎣
∂
∂
α
+
c
x
∂
∂
γ
∂
∂
β
+
c
y
∂
∂
γ
c
z
∂
∂
γ
⎤
⎥
⎥
⎥
⎥
⎦
.
(
12
)
The proposed viscoacoustic wavefield simulation in a vertical stretched grid can be summarized into the following steps. First, with the elevation of topography ζ(x, y), we compute its derivative with respect to x and y and the topography related coordinate stretching parameters cx and cy. Then, the irregular physical space is mapped to a regular computational domain by vertical stretching according to Eq. 8, in which velocity, density and Q parameters onto the computational grids are calculated using a linear interpolation method. Next, the viscoacoustic wave equation 11 is solved in a regularly-sampled computational domain using any available numerical solvers. Finally, the wavefields in the real physical space are reconstructed by mapping the extrapolated wavefields back with the same interpolation algorithm used in the second step.

Numerical implementation using a fully staggered-grid finite difference scheme
Considering the trade-off of computational accuracy and efficiency, we choose the time-domain staggered-grid finite-difference scheme to solve the viscoacoustic wave Eq. 11. Because of vertical stretching, it is difficult for the standard staggered-grid finite-difference method (Virieux, 1986) to accurately compute the partial derivatives such as ∂vx/∂γ and ∂vy/∂γ. Here we discretize and solve the wave equation using a fully staggered-grid approach (Lebedev, 1964; Lisitsa and Vishnevskiy, 2010; de la Puente et al., 2014). The nodes distribution is presented in Figure 2. Unlike the standard staggered-grid approach, the fully staggered-grid finite-difference scheme has three particle velocity components at the half grids (yellow triangles in Figure 2B), and three additional pressure wavefields (red circles in Figure 2B). For the time derivative, we still adopt a second-order finite-difference method, which results in the following updating scheme:

⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
p
n
+
1
=
p
n
+
Δ
t
ρ
v
2
p
[
(
1
+
s
Q
)
(
(
D
α
+
c
x
D
γ
)
v
n
+
1
/
2
x
+
(
D
β
+
c
y
D
γ
)
v
n
+
1
/
2
y
+
c
z
D
γ
v
n
+
1
/
2
z
)
]
−
1
2
Q
∑
N
l
=
1
(
Φ
(
l
)
,
n
+
Φ
(
l
)
,
n
+
1
)
,
Φ
(
l
)
,
n
+
1
=
1
−
Δ
t
/
(
2
τ
(
l
)
)
1
+
Δ
t
/
(
2
τ
(
l
)
)
Φ
(
l
)
,
n
+
Δ
t
1
+
Δ
t
/
(
2
τ
(
l
)
)
D
(
l
)
τ
(
l
)
[
(
D
α
+
c
x
D
γ
)
v
n
+
1
/
2
x
+
(
D
β
+
c
y
D
γ
)
v
n
+
1
/
2
y
+
c
z
D
γ
v
n
+
1
/
2
z
]
,
v
n
+
3
/
2
x
=
v
n
+
1
/
2
x
+
Δ
t
ρ
[
D
α
p
n
+
1
+
c
x
D
γ
p
n
+
1
]
,
v
n
+
3
/
2
y
=
v
n
+
1
/
2
y
+
Δ
t
ρ
[
D
β
p
n
+
1
+
c
y
D
γ
p
n
+
1
]
,
v
n
+
3
/
2
z
=
v
n
+
1
/
2
z
+
Δ
t
ρ
[
c
z
D
γ
p
n
+
1
]
,
(
13
)
where Di (i = α, β, γ) denotes the finite-difference operator for first-order spatial derivative. All components of pressure, particle velocity and memory variable wavefields are iteratively computed based on Eq. 13, and each partial derivative can be accurately calculated. Taking pn+1 at (i, j, k) as an example, we compute 
D
α
v
n
+
1
/
2
x
 and 
D
γ
v
n
+
1
/
2
x
 using x-component particle velocities at (i ± m/2, j, k) and (i, j, k ± m/2), compute 
D
β
v
n
+
1
/
2
y
 and 
D
γ
v
n
+
1
/
2
y
 using y-component particle velocities at (i, j ± m/2, k) and (i, j, k ± m/2), and compute 
D
γ
v
n
+
1
/
2
z
 using z-component particle velocity at (i, j, k ± m/2), respectively. m = (1, 2 … M), where M denotes the half length of finite-difference operator. The other variables at different nodes can be calculated using the same finite-difference scheme. In numerical examples, we set the M = 4 and achieve an eighth-order accuracy in space, and the staggered-grid finite-difference coefficients are calculated using the Taylor expansion. To ensure the stability of the finite-difference solver, the temporal increment needs to satisfy the Courant-Friedrichs-Lewy (CFL) condition. In the vertically stretched grid, the relation between time and space increments is (the detailed derivation is given in Appendix A)

Δ
t
≤
Δ
h
c
v
m
a
x
√
(
1
+
s
Q
m
i
n
)
[
(
1
+
c
x
,
m
a
x
)
2
+
(
1
+
c
y
,
m
a
x
)
2
+
(
c
z
,
m
a
x
)
2
]
,
(
14
)
where c is the summation of finite-difference coefficients, vmax denotes the maximum velocity, Qmin denotes the minimum quality factor value, and 
c
x
i
,
m
a
x
 (xi = x, y, z) denotes the maximum value of topography associated coefficients in Eq. 10. For acoustic medium and a flat surface, Q tends to infinity, cx = cy = 0 and cz = 1. Eq. 14 is simplified to a traditional CFL condition:

Δ
t
≤
Δ
h
√
3
c
v
m
a
x
.
(
15
)
FIGURE 2
www.frontiersin.org
FIGURE 2. Comparison of the node distribution in the standard (A) and fully (B) staggered-grid finite-difference methods. p denotes the pressure wavefield, Φ denotes the memory variable, and 
v
x
i
 (xi=x, y, z) denotes particle velocity.

The free-surface boundary condition in the viscoacoustic modeling is implemented using a simple image method (Zhang et al., 2012). In addition, because two types of grids at different locations are coupled in the fully staggered-grid finite-difference scheme, spurious waves may occur if loading source incorrectly (Koene et al., 2021). To avoid these spurious waves, we adopt the strategy proposed by Lisitsa and Vishnevskiy (2010) and de la Puente et al. (2014), which is implemented for loading a point source by adding the source function at a node of (i, j, k) and at additional sub-nodes of (i ± 1/2, j ± 1/2, k) (i ± 1/2, j, k ± 1/2), (i, j ± 1/2, k ± 1/2) with a scale of 0.25. Seismograms are extracted using a similar strategy by summing the weighted records at a main node and sub-nodes of receiver locations.

A simulation example for a homogeneous model is presented in Figure 3. P-wave velocity is 3 km/s, Q is 50, and a 200-m-thick vacuum layer is set at the top to simulate surface reflections. Acoustic and two kinds of viscoacoustic solvers are used to compute seismic wavefields, and the result of generalized standard linear solid (GSLS) method is used as a reference for comparison. Because of the phase dispersion and energy dissipation, viscoacoustic waves propagate faster than acoustic waves and have much weaker amplitudes (Figures 3C,D). The surface at the z = 0 km produces a reflection with opposite polarity compared with the direct wave (Figure 3B). The waveforms computed using the proposed method have good agreements with those of GSLS in terms of both phases and amplitudes (red dot and black solid lines Figures 3C,D).

FIGURE 3
www.frontiersin.org
FIGURE 3. Comparison of wavefield simulation in a homogeneous medium. Panels (A,B) are acoustic (Ac) and viscoacoustic (Visco) wavefields at 0.5 s and 0.9 s. Panels (C,D) are single-trace comparisons extracted from (A,B). Blue solid lines denote acoustic results. Black solid lines denote viscoacoustic results computed using the generalized standard linear solid (GSLS) method, which are used as the references. Red dot lines are the results computed using the proposed method.

Numerical experiments
To test the performance of the proposed viscoacoustic modeling method, we apply it to a simple layer model and 2D/3D realistic Loess Plateau models. In the computation, the spatial accuracy of finite-difference is eighth order and the temporal accuracy is second order.

A simple layer model
The first example is a three layer model, of which the velocity and Q values are shown in Figure 4A. A sinusoidal topography is designed to simulate the irregular surface. This model is discretized on a 601 × 501 grid with a 10-m spatial increment. A Ricker wavelet with the peak frequency of 15 Hz is used as the source time function. The source is deployed 10 m below the topography, and 501 receivers are evenly distributed horizontally on the observation surface. Time increment is 1 ms and duration is 6 s. Figure 4B shows the vertically distorted model in the computational domain. The topography has been fattened, but the originally horizontal interfaces in subsurface are curved. This coordinate conversion make it easy to simulate wave propagation in the near surface region.

FIGURE 4
www.frontiersin.org
FIGURE 4. A three-layer model in the physical space (A) and computational domain (B). Red star denotes the source location, and magenta line denotes receivers.

The snapshots computed by solving the viscoacoustic and acoustic wave equations with and without the free surface are presented in Figures 5, 6. In the computational domain, the wavefronts of direct and reflected waves are distorted because of cx, cy, and cz coefficients in Eq. 11 associated with the topography (Figure 5A–C, Figure 6A–C). In contrast, in the physical domain, the direct wave becomes regular with a half-circle wavefront, and transmitted and reflected waves are generated at the interfaces (Figure 5D–F, Figure 6D–F). The free surface at topography produces complicated boundary reflections, which intersects with deep effective wavefields (Figures 6D–F). Compared with acoustic modeling results, viscoacoustic wavefields have similar amplitudes and phases during early time, but they show considerably traveltime and amplitude differences as the propagation time increases (Figure 7).

FIGURE 5
www.frontiersin.org
FIGURE 5. Viscoacoustic wavefields of different propagation times with a top absorption boundary in the computational domain (A–C) and physical space (D–F). The cyan lines in panels (D–F) denote the topography.

FIGURE 6
www.frontiersin.org
FIGURE 6. Viscoacoustic wavefields of different propagation times with a free-surface boundary in the computational domain (A–C) and physical space (D–F). The cyan lines in panels (D–F) denote the topography.

FIGURE 7
www.frontiersin.org
FIGURE 7. (A–F) Comparisons of acoustic (left half panel) and viscoacoustic (right half panel) wavefields at different propagation times. A free surface is used as the boundary condition on the topography. (G) Single-trace comparison at x = 3 km, and (H) corresponding spectra comparison, in which blue lines denotes acoustic results and red lines denote viscoacoustic results. The cyan lines in (A–F) denote the topography.

The common-shot gathers are presented in Figures 8, 9. For comparison, we also compute the record using the GSLS method and utilize it as a reference, in which three relaxation mechanisms are used to approximate a frequency-independent Q. Without the free surface, common-shot records only have a direct wave and two subsurface reflections. The direct waves computed using acoustic and viscoacoustic simulations have similar waveforms due to short propagation time. By contrast, the deep reflectors of viscoacoustic records, especially for the one from second interface, have different phases and much weaker amplitudes than acoustic records (Figure 8D). The GSLS benchmark result has a good agreement with that of the proposed method, indicating that the new method can accurately simulate viscoacoustic propagation with irregular topography (black solid lines and red dot lines in Figures 8D, 9D). In addition, the reflected events are no longer hyperbolic due to topographic surface, and incorporating the free surface in the modeling introduces many surface-related multiples (Figure 9).

FIGURE 8
www.frontiersin.org
FIGURE 8. Common-shot gathers simulated with a top absorption boundary for the three-layer model. (A) Acoustic modeling, (B) viscoacoustic modeling using the GSLS method, (C) viscoacoustic modeling using the proposed method, and (D) single-trace comparison at the offset of −2.3 km. The amplitudes of panel (D) are normalized by the maximum value of direct waves.

FIGURE 9
www.frontiersin.org
FIGURE 9. (A–D) Common-shot gathers simulated with a top free-surface boundary for the three-layer model. The panel notifications are the same as in Figure 8.

2D Loess Plateau model
According to the outcrop of Chinese Loess Plateau, we build a realistic model for seismic modeling (Figure 10). Four layers are designed to mimic real loess structures: 1) a weathering layer with dry loess, 2) a low-velocity layer with wet loess, 3) a transition layer with water saturated loess, and 4) a Tertiary soil layer. Detailed P-wave velocity and Q values of these layers are given in Table 2. The maximum thickness of loess is about 300 m (Figure 10A), and low Q values in the dry and wet loess layers can produce strong seismic attenuation. This model is discretized onto a 1,000 × 2601 grid with a 5-m spacing. The source is located at x = 6.15 km horizontally and z = −1.18 km vertically with a 15-Hz Ricker wavelet as the source time function. The projected velocity in the computational domain is shown in Figure 10B, of which the surface is flattened and subsurface structures are slightly distorted.

FIGURE 10
www.frontiersin.org
FIGURE 10. 2D Loess Plateau model. (A) P-wave velocity model, (B) mapped velocity model in the computational domain, and (C) quality factor Q model. The Q value above topography is 1,000 and is clipped to 80 for plotting.

TABLE 2
www.frontiersin.org
TABLE 2. P-wave velocity and Q values of loess layers.

The snapshots in the computational domain and physical space computed with and without the free surface are shown in Figures 11, 12. With a top absorption boundary condition, the reflected waves of subsurface interfaces can be clearly distinguished from direct waves (Figure 11). The wavefronts in the computational domain are slightly distorted and appear to be non-continuous because of irregular topography (left column in Figure 11). After mapping back to the physical domain, the wavefields, especially for reflections, have regular half-circle wavefronts (right column in Figure 11). By setting the topography as a free surface, seismic waves propagate back and forth between top surface and loess bottom vertically and between hill and ditch horizontally, resulting in strong multiple-like scatterings. These scatterings contaminate effective reflections generated from deep interfaces (Figure 12). Comparisons between acoustic and viscoacoustic modeling show a similar result as in the example of layer model (Figure 13). Their waveforms are similar when the propagation time is less than 0.5 s (Figure 13A). But as the time increases to 1 s, the difference of phases and amplitudes can be visually observed (Figure 13B). With a further longer duration, viscoacoustic wavefields have considerably weaker amplitudes than acoustic modeling results (Figures 13C,D).

FIGURE 11
www.frontiersin.org
FIGURE 11. (A–H) Viscoacoustic wavefields of 2D Loess Plateau model at different propagation times simulated with a top absorption boundary in the computational domain (left column) and physical domain (right column). The cyan lines in panels (B,D,F, and H) denote the topography.

FIGURE 12
www.frontiersin.org
FIGURE 12. (A–H) Viscoacoustic wavefields of different propagation times for the 2D Loess Plateau model simulated with a top free-surface boundary in the computational domain (left column) and physical domain (right column). The cyan lines in panels (B,D,F, and H) denote the topography.

FIGURE 13
www.frontiersin.org
FIGURE 13. (A–D) Comparison of acoustic (left half panel) and viscoacoustic (right half panel) wavefields for the 2D Loess Plateau model at different propagation times. The cyan lines denote the topography.

The corresponding common-shot gathers are presented in Figure 14. Large velocity contrasts between loess layers and basement produce complicated refractions around the first break, and irregular topography results in distorted non-hyperbolic reflections (Figure 14A). Incorporating the free surface into viscoacoustic modeling produces strong scattering noises near the direct wave, and deep effective reflections are totally submerged in the noise (Figure 14B). For comparison, we also compute acoustic records using the same model and observation settings. Similar to the analysis for snapshots, the events at a short time have similar phases and amplitudes on acoustic and viscoacoustic records (Figures 14C,D). But considerable difference of deep reflections can be observed as the time increases due to attenuation-related phase dispersion and amplitude dissipation. In addition, large-offset refractions and scatterings near direct wave of viscoacoustic record are much weaker than those of acoustic modeling results. This is caused by strong attenuation in the low-Q loess layers.

FIGURE 14
www.frontiersin.org
FIGURE 14. Common-shot gathers of 2D Loess Plateau model (A,B) Viscoacoustic modeling with top absorption and free surface boundaries, (C,D) comparison of acoustic (left half panel) and viscoacoustic (right half panel) records computed with top absorption and free surface boundaries.

3D Loess Plateau model
Because 2D modeling cannot accurately simulate the amplitudes of seismic waves, we apply the proposed viscoacoustic modeling method to a more realistic 3D model (Figure 15). Compared with 2D Loess Plateau model, geographic characteristics of loess distribution, including typical ditch, hill and valley, are more clearly visible in the 3D model. The setting for Q in shallow loess layers is the same to that in 2D model. For deep sandstone strata, the well-logging data and rock physics analysis show that P-wave velocity and Q models crudely satisfy an empirical relation as 
Q
=
√
v
p
, where vp denotes P-wave velocity with the unit of m/s. This model is discretized by 475 × 1,301×800 nodes with a 10-m increment. 650 × 200 receivers along inline and crossline directions are uniformly deployed to record seismograms (blue dots in Figure 16). Three experiments are carried out with sources in the ditch, hill and valley, respectively (red stars in Figure 16). Time increment in the finite-difference is 0.5 ms and duration is 7 s.

FIGURE 15
www.frontiersin.org
FIGURE 15. 3D Loess Plateau model. (A) P-wave velocity, and (B) Q model. The Q value above topography is 1,000 and is clipped to 80 for plotting.

FIGURE 16
www.frontiersin.org
FIGURE 16. Source and receiver distributions of three observation systems for 3D wavefield models. Red stars denote the source locations of three experiments at the ditch (1), hill (2) and valley (3), and blue dots denote receivers.

The snapshots and common-shot gathers are presented in Figures 17, 18. Similar to 2D modeling, the interactions between topographic free-surface and loess bottom produces strong scatterings in near-surface region, which contaminate deep reflections (Figure 17). This leads to typical “black-triangle” noise below the source location in the records (Figure 18A). Without subsequent processing, it is difficult to visually find hyperbolic reflections. Because of the geometric spreading in a 3D volume, wavefield amplitude decays faster during propagation than in the 2D case. In addition, seismic attenuation introduces strong amplitude dissipation for viscoacoustic waves (right column in Figure 17). This results in rather weak amplitudes at large-offset traces and large observation time compared with acoustic recordings (Figures 18B,C).

FIGURE 17
www.frontiersin.org
FIGURE 17. Comparison of acoustic (A,C,E,G,I) and viscoacoustic (B,D,F,H,J) wavefields with the source location at the ditch (No. 1 in Figure 16).

FIGURE 18
www.frontiersin.org
FIGURE 18. Common-shot gathers of 3D Loess Plateau model with the source location at the ditch. (A) Acoustic modeling result, (B) viscoacoustic modeling result, and (C) comparison of acoustic (Ac) versus viscoacoustic (Visco) modeling results.

The modeling results of the other two experiments are shown in Figures 19–21. Thicker loess sediments in the hill and valley produce stronger attenuation effect on seismic waves than that in the ditch, resulting in large amplitude and phase difference between acoustic and viscoacoustic snapshots (Figure 19). The phase dispersion and amplitude dissipation of viscoacoustic recordings become more pronounced. The waveforms with large offsets and times, including near-surface-related scatterings and deep reflections, are attenuated quickly (Figures 20, 21). In contrast to acoustic recordings, no events can be observed visually at the time greater than 5 s. The low SNR and weak amplitudes of recordings pose a great challenge for subsequent seismic data processing and imaging.

FIGURE 19
www.frontiersin.org
FIGURE 19. Comparison of acoustic and viscoacoustic wavefields with the source locations at the hill [(A,C,E,G,I), No. 2 in Figure 16] and valley [(B,D,F,H,J), No. 3 in Figure 16].

FIGURE 20
www.frontiersin.org
FIGURE 20. (A–C) Common-shot gathers of 3D Loess Plateau model with the source location at the hill. The panel notations are the same as those in Figure 18.

FIGURE 21
www.frontiersin.org
FIGURE 21. (A–C) Common-shot gathers of 3D Loess Plateau model with the source location at the valley. The panel notations are the same as those in Figure 18.

Figure 22 shows the snapshots of 1.5 s on the observation surface for three experiments. In the first experiment, strong scatterings are generated and propagate along the north-south ditch (Figures 22A,B). This is because the loess in the ditch was eroded, and the outcrop has a relative higher velocity than the loess. In contrast, the experiments excited on the hill and valley show an isotropic scattering pattern (Figures 22C–F). In addition, the wavefields excited by the source on the hill are affected by attenuation more largely than those excited in the ditch and valley (Figures 22D,F). Comparisons of acoustic modeling result, viscoacoustic modeling result and a common-shot gather acquired from Chinese Loess Plateau are presented in Figure 23. Note that both acoustic and viscoacoustic modeling can simulate strong black-triangle scattering noise below the direct waves, which has a consistent kinematic pattern with the field data. But acoustic records have relatively stronger amplitudes for the time greater than 3 s (Figure 23B). By incorporating seismic attenuation, viscoacoustic modeling produces weak amplitudes for large-duration and large-offset events, which have a good agreement with the amplitude characteristic of field data (Figure 23C).

FIGURE 22
www.frontiersin.org
FIGURE 22. Acoustic (left column) and viscoacoustic (right column) wavefields on the topographic surface at 1.5 s. (A,B), (C,D), and (E,F) are the results excited by the source at three different locations, respectively.

FIGURE 23
www.frontiersin.org
FIGURE 23. Comparison of synthetic common-shot gathers with field data acquired from Chinese Loess Plateau. (A) 3D acoustic modeling result, (B) 3D viscoacoustic modeling result, and (C) field data.

Discussion
To study wave propagations in the Loess Plateau, we propose a viscoacoustic modeling method based upon a wave equation with the explicitly expressed Q. It does not need to convert Q to strain and stress relaxation times as in the GSLS method. But compared with the fractional Laplacian complex-valued wave equations (Zhu and Harris, 2014; Yang and Zhu, 2018), the proposed equation does not separate the dispersion and dissipation terms. This makes it not as easy as Zhu and Harris (2014) and Yang and Zhu (2018)’s methods to directly compensate for Q effect in the reverse-time migration. An appropriate Q-compensation strategy will be investigated for seismic imaging in the future.

In this study, we do not incorporate the elasticity and anisotropy into wavefield modeling, and therefore cannot simulate S-wave propagation and P-S conversion. More accurate wavefield simulation should be extended to an anisotropic and anelastic medium, which can describe both P- and S-wave propagations in the Loess Plateau. But for elastic modeling, the S-wave velocity of loess layers can be as low as 200–300 m/s. This requires a very fine grid (
<
 5 m) to avoid numerical dispersion in the finite-difference modeling method, which will significantly increase the computational cost. A combined grid strategy, which uses a curvilinear grid in the near-surface zone and a regular Cartesian grid at depth, can be introduced to alleviate the computational burden (Sjögreen and Petersson, 2012). In addition, the spectral-element method based on a spatially varying grid is another way to accurately simulate anisotropic and (an)elastic wave propagation in the Loess Plateau (Komatitsch and Tromp, 1999).

From 2D/3D modeling results for the Loess Plateau model, there is strong black-triangle scattering noise below the direct waves, which is consistent with the field observation. The generation mechanism of this type noise is similar to that of interval multiples, which results from the wave propagation back and forth between top free surface and loess bottom vertically and between hill and ditch horizontally. If incorporating elasticity in the modeling, surface waves will interact with the scatterings and produce more complicated noise. In subsequent processing, it is critical to remove the effect of strong black-triangle noise to produce a high-quality image, and therefore advanced signal processing techniques should be adopted to suppress loess-related noise.

Conclusion
We present a 2D/3D viscoacoustic modeling method in this work and apply it to simulate wave propagation in the Loess Plateau. A viscoacoustic wave equation with the explicitly expressed Q is first derived to describe the phase dispersion and amplitude dissipation. Then, a vertically deformed grid is used to conforms to the topographic surface, which build a mapping relation between physical space and computational domain. To accurately computed the spatial derivatives, a fully staggered-grid finite-difference scheme is utilized to solve the viscoacoustic wave equation in the deformed grid. Numerical experiments demonstrate that the proposed method can accurately simulate viscoacoustic wave propagation in the Loess Plateau models. The 3D modeling results show consistent kinematic and dynamic characteristics with the field data acquired from the Loess Plateau in China.

Data availability statement
The original contributions presented in the study are included in the article/supplementary material, further inquiries can be directed to the corresponding author.

Author contributions
ZH presented the idea, JY, LH, JH, and SQ developed the code, did the tests and wrote the manuscript. JS and YY revised the manuscript.

